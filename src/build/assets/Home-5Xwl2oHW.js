import{u as x,a as p,j as e,M as C,B as k,s as u,r as d,b as c,c as S,d as M,e as U,f as D,L as A,g as B,h as P,i as z,k as E}from"./index-R8GyF8uZ.js";import{B as r}from"./Button-LusWiWP9.js";const I=({open:l,children:s,handleClose:t,handleClick:n})=>e.jsx(C,{open:l,onClose:t,children:e.jsxs(k,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsx("div",{className:"overflow-scroll w-full h-[500px]",children:s}),e.jsxs("div",{className:"flex mt-5 flex-row items-center justify-start",children:[e.jsx(r,{onClick:t,variant:"contained",color:"primary",children:"Close"}),e.jsx(r,{onClick:n,variant:"contained",color:"primary",sx:{ml:2},children:"Save"})]})]})}),T=({children:l,handleClick:s})=>{const t=x(h=>h.modal.show),n=p(),i=()=>{n(u({show:!1}))};return e.jsx("div",{children:e.jsx(I,{open:t,handleClick:s,handleClose:i,children:l})})},V=()=>{const l=d.useRef(null),s=p(),t=x(a=>a.file.update),n=x(a=>a.file.file),[i,h]=d.useState(null),[v,m]=d.useState(null);console.log(t,"called"),d.useEffect(()=>{var a;t&&((a=l==null?void 0:l.current)==null||a.click())},[t]);const N=a=>{var f;const o=(f=a.target.files)==null?void 0:f[0];if(h(o||null),o&&o.type==="text/plain"){const j=new FileReader;j.onload=y=>{var w;const b=(w=y.target)==null?void 0:w.result;m(b),F()},j.readAsText(o)}else m(null),s(o?c({message:"Please upload file",show:!0,status:"error"}):c({message:"Invalid file type",show:!0,status:"error"}))},g=()=>{if(i)if(i.type==="text/plain")if(i.size<=10*1024){const a=new FormData;a.append("file",i),s(t?S(a,n):M(a)),s(u({show:!1})),h(null),m(null)}else s(c({message:"File size exceeds the limit. Please upload a file smaller than 300 KB.",show:!0,status:"error"}));else s(c({message:"Invalid file type. Please upload a text file (txt).",show:!0,status:"error"}));else s(c({message:"Please select a file to upload.",show:!0,status:"error"}))},F=()=>{s(u({show:!0}))};return e.jsxs("div",{children:[e.jsx("input",{id:"contained-button-file",type:"file",accept:"text/plain",onChange:N,style:{display:"none"}}),e.jsx("label",{htmlFor:"contained-button-file",children:e.jsx(r,{ref:l,variant:"contained",component:"span",children:"Upload file"})}),e.jsx(T,{handleClick:g,children:e.jsxs("div",{children:[e.jsx("h1",{children:"File Preview:"}),e.jsx("pre",{children:v})]})})]})},H=V,L=U(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),R=({originalName:l,id:s})=>{const t=p(),n=i=>{t(B(i)),t(P(Math.random()))};return e.jsxs("div",{className:"flex flex-row border-gray-200 px-1 md:px-4 rounded-lg py-2 border my-2  items-center",children:[e.jsx("div",{className:"w-1/4",children:e.jsx("span",{className:"md:text-xl text-xs",children:l})}),e.jsx("div",{className:"w-1/4 line-clamp-2",children:e.jsx("span",{className:"md:text-xl text-xs",children:s})}),e.jsxs("div",{className:"w-1/4 text-center",children:[e.jsx(r,{onClick:()=>n(s),children:"Update"}),e.jsx(r,{variant:"contained",onClick:()=>{t(D(s))},color:"error",children:e.jsx(L,{})})]}),e.jsx("div",{className:"w-1/4 text-end",children:e.jsx(A,{to:`/file/${s}`,children:e.jsx(r,{children:"View"})})})]})},$=({rows:l})=>e.jsx("div",{className:"shadow-lg p-2 md:p-5 my-10 rounded-lg",children:l.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-row border border-gray-200 px-1 md:px-4 rounded-lg py-2 items-center justify-between",children:[e.jsx("div",{className:"w-1/4",children:e.jsx("span",{className:"md:text-xl text-xs",children:"File Name"})}),e.jsx("div",{className:"w-1/4",children:e.jsx("span",{className:"md:text-xl text-xs",children:"File Id"})}),e.jsx("div",{className:"w-1/4 text-center",children:e.jsx("span",{className:"md:text-xl text-xs",children:"Actions"})}),e.jsx("div",{className:"w-1/4 text-end",children:e.jsx("span",{className:"md:text-xl text-xs",children:"View File"})})]}),l.map(s=>e.jsx(R,{...s},s.id))]}):e.jsx("div",{className:"p-10 flex items-center justify-center",children:e.jsx("span",{children:"No Files Found Please upload one"})})}),K=$;function G(){const l=x(n=>n.file.files),s=x(n=>n.user.isAuth),t=p();return d.useEffect(()=>{s&&t(z())},[s]),e.jsx(E,{children:e.jsxs("div",{className:"w-[95%] md:w-[80%] md:m-auto",children:[e.jsx(H,{}),e.jsx("div",{className:"mt-10",children:e.jsx(K,{rows:l})})]})})}export{G as default};
